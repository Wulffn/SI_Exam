package dk.mwnck.utils;

import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.api.Test;

import java.text.ParseException;
import java.util.HashMap;
import java.util.Locale;
import java.util.Map;

import static org.junit.jupiter.api.Assertions.assertEquals;

public class PickerTest
{
    // UUT
    // PriceCurrencyPicker.

    public static Map<String, Object> cars = new HashMap<>();
    
    @BeforeAll
    public static void setup()
    {
        cars.clear();
        cars.put("car1", "{\"id\":\"5fd364ef5c0c725a9ac924e5\",\"manufacturer\":\"Kia\",\"model\":\"Picanto\",\"price\":\"€ 3,650.-\",\"km\":52000,\"year\":2012,\"country\":\"DE\",\"currency\":\"EUR\"}");
        //{5fd364ef5c0c725a9ac924e5={"id":"5fd364ef5c0c725a9ac924e5","manufacturer":"Kia","model":"Picanto","price":"€ 3,650.-","km":52000,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973618464161851,"time":1607689452,"bsonType":"TIMESTAMP","inc":59,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924e4={"id":"5fd364ef5c0c725a9ac924e4","manufacturer":"Kia","model":"Picanto","price":"€ 4,900.-","km":66000,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973618464161845,"time":1607689452,"bsonType":"TIMESTAMP","inc":53,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924e3={"id":"5fd364ef5c0c725a9ac924e3","manufacturer":"Kia","model":"Picanto","price":"€ 4,740.-","km":45248,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973618464161843,"time":1607689452,"bsonType":"TIMESTAMP","inc":51,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924e2={"id":"5fd364ef5c0c725a9ac924e2","manufacturer":"Kia","model":"Picanto","price":"6.500 €","km":60000,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973618464161841,"time":1607689452,"bsonType":"TIMESTAMP","inc":49,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924e1={"id":"5fd364ef5c0c725a9ac924e1","manufacturer":"Kia","model":"Picanto","price":"4.100 €","km":38000,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973618464161839,"time":1607689452,"bsonType":"TIMESTAMP","inc":47,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924e0={"id":"5fd364ef5c0c725a9ac924e0","manufacturer":"Kia","model":"Picanto","price":"4.100 €","km":66999,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973618464161837,"time":1607689452,"bsonType":"TIMESTAMP","inc":45,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364f05c0c725a9ac924f4={"id":"5fd364f05c0c725a9ac924f4","manufacturer":"Kia","model":"Picanto","price":"€ 5,300.-","km":66300,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973622759129157,"time":1607689453,"bsonType":"TIMESTAMP","inc":69,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364f05c0c725a9ac924f5={"id":"5fd364f05c0c725a9ac924f5","manufacturer":"Kia","model":"Picanto","price":"€ 5,300.-","km":70000,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973622759129161,"time":1607689453,"bsonType":"TIMESTAMP","inc":73,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924e9={"id":"5fd364ef5c0c725a9ac924e9","manufacturer":"Kia","model":"Picanto","price":"€ 4,700.-","km":58818,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973622759129097,"time":1607689453,"bsonType":"TIMESTAMP","inc":9,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924e8={"id":"5fd364ef5c0c725a9ac924e8","manufacturer":"Kia","model":"Picanto","price":"€ 4,650.-","km":65000,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973622759129095,"time":1607689453,"bsonType":"TIMESTAMP","inc":7,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ee5c0c725a9ac924da={"id":"5fd364ee5c0c725a9ac924da","manufacturer":"Kia","model":"Picanto","price":"45.000 kr.","km":61000,"year":2012,"country":"DK","currency":"EUR","created":{"value":6904973618464161819,"time":1607689452,"bsonType":"TIMESTAMP","inc":27,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924e7={"id":"5fd364ef5c0c725a9ac924e7","manufacturer":"Kia","model":"Picanto","price":"€ 4,600.-","km":47000,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973622759129093,"time":1607689453,"bsonType":"TIMESTAMP","inc":5,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924e6={"id":"5fd364ef5c0c725a9ac924e6","manufacturer":"Kia","model":"Picanto","price":"€ 3,800.-","km":68530,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973622759129091,"time":1607689453,"bsonType":"TIMESTAMP","inc":3,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924ee={"id":"5fd364ef5c0c725a9ac924ee","manufacturer":"Kia","model":"Picanto","price":"€ 4,980.-","km":68000,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973622759129125,"time":1607689453,"bsonType":"TIMESTAMP","inc":37,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924ed={"id":"5fd364ef5c0c725a9ac924ed","manufacturer":"Kia","model":"Picanto","price":"€ 4,950.-","km":67000,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973622759129119,"time":1607689453,"bsonType":"TIMESTAMP","inc":31,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924ec={"id":"5fd364ef5c0c725a9ac924ec","manufacturer":"Kia","model":"Picanto","price":"€ 4,880.-","km":62000,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973622759129107,"time":1607689453,"bsonType":"TIMESTAMP","inc":19,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924eb={"id":"5fd364ef5c0c725a9ac924eb","manufacturer":"Kia","model":"Picanto","price":"€ 4,800.-","km":38000,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973622759129103,"time":1607689453,"bsonType":"TIMESTAMP","inc":15,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924ea={"id":"5fd364ef5c0c725a9ac924ea","manufacturer":"Kia","model":"Picanto","price":"€ 4,700.-","km":65000,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973622759129099,"time":1607689453,"bsonType":"TIMESTAMP","inc":11,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ee5c0c725a9ac924d9={"id":"5fd364ee5c0c725a9ac924d9","manufacturer":"Kia","model":"Picanto","price":"44.900 kr.","km":41000,"year":2012,"country":"DK","currency":"EUR","created":{"value":6904973618464161815,"time":1607689452,"bsonType":"TIMESTAMP","inc":23,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924ef={"id":"5fd364ef5c0c725a9ac924ef","manufacturer":"Kia","model":"Picanto","price":"€ 4,990.-","km":40030,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973622759129127,"time":1607689453,"bsonType":"TIMESTAMP","inc":39,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924f3={"id":"5fd364ef5c0c725a9ac924f3","manufacturer":"Kia","model":"Picanto","price":"€ 5,250.-","km":57000,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973622759129151,"time":1607689453,"bsonType":"TIMESTAMP","inc":63,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924f2={"id":"5fd364ef5c0c725a9ac924f2","manufacturer":"Kia","model":"Picanto","price":"€ 5,250.-","km":60000,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973622759129143,"time":1607689453,"bsonType":"TIMESTAMP","inc":55,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924f1={"id":"5fd364ef5c0c725a9ac924f1","manufacturer":"Kia","model":"Picanto","price":"€ 5,250.-","km":60000,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973622759129135,"time":1607689453,"bsonType":"TIMESTAMP","inc":47,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924f0={"id":"5fd364ef5c0c725a9ac924f0","manufacturer":"Kia","model":"Picanto","price":"€ 4,990.-","km":64559,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973622759129129,"time":1607689453,"bsonType":"TIMESTAMP","inc":41,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924dd={"id":"5fd364ef5c0c725a9ac924dd","manufacturer":"Kia","model":"Picanto","price":"7.190 €","km":44000,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973618464161825,"time":1607689452,"bsonType":"TIMESTAMP","inc":33,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924dc={"id":"5fd364ef5c0c725a9ac924dc","manufacturer":"Kia","model":"Picanto","price":"5.555 €","km":49358,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973618464161823,"time":1607689452,"bsonType":"TIMESTAMP","inc":31,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924db={"id":"5fd364ef5c0c725a9ac924db","manufacturer":"Kia","model":"Picanto","price":"49.900 kr.","km":59000,"year":2012,"country":"DK","currency":"EUR","created":{"value":6904973618464161821,"time":1607689452,"bsonType":"TIMESTAMP","inc":29,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364f05c0c725a9ac924f6={"id":"5fd364f05c0c725a9ac924f6","manufacturer":"Kia","model":"Picanto","price":"€ 5,400.-","km":70000,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973622759129165,"time":1607689453,"bsonType":"TIMESTAMP","inc":77,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924df={"id":"5fd364ef5c0c725a9ac924df","manufacturer":"Kia","model":"Picanto","price":"4.880 €","km":62000,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973618464161831,"time":1607689452,"bsonType":"TIMESTAMP","inc":39,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}, 5fd364ef5c0c725a9ac924de={"id":"5fd364ef5c0c725a9ac924de","manufacturer":"Kia","model":"Picanto","price":"4.900 €","km":66000,"year":2012,"country":"DE","currency":"EUR","created":{"value":6904973618464161827,"time":1607689452,"bsonType":"TIMESTAMP","inc":35,"array":false,"null":false,"number":false,"double":false,"boolean":false,"binary":false,"regularExpression":false,"javaScriptWithScope":false,"document":false,"string":false,"int32":false,"decimal128":false,"dbpointer":false,"objectId":false,"timestamp":true,"int64":false,"javaScript":false,"symbol":false,"dateTime":false}}}
    }

    @Test
    public void mustPickCurrencyAndPrice() {
        // Arrange
        var expected = 2;

        // Act
        Map<String, Object> properties = Picker.pick(Picker.toMap(cars.get("car1").toString()), "price", "currency");
        int result = properties.size();

        // Assert
        assertEquals(expected, result);
    }

    @Test
    public void mustReturnDoubleFromPriceWithLeadingCurrency() throws ParseException
    {
        // Arrange
        var expected = 3650D;
        String price = "€ 3,650.-";

        // Act
        var result = Picker.priceStringToDouble(price);

        // Assert
        assertEquals(expected, result);
    }
}
